[header](_header.md ':include')

# Project Configuration

Project files are named `saasify.json` and should be placed at the root of your project similar to how `package.json` files work.

## Debugging

To quickly check whether or not your `saasify.json` file is valid, you can run `saasify debug` from within your project's directory or run `saasify debug <path-to-saasify.json>`.

<p align="center">
  <img src="./_media/undraw/bug_fixing.svg" alt="Debugging" width="200" />
</p>

## Specification

`saasify.json` should be a valid JSON file that conforms to the following TypeScript pseudocode:

!> This config may look complicated, but most fields are optional with sensible defaults. Start with a really simple config that just specifies your `services` and only customize further once you're ready to publish your SaaS product.

```ts
class Config {
  saasifyVersion?: number = 1
  version?: string = 0.1.0
  name?: string
  amountPerBase?: number = 99
  amountPerRequest?: number = 0.04
  amountPerCompute?: number = 0.34
  amountPerBandwidth?: number = 20
  authRateLimit?: RateLimit
  noAuthRateLimit?: RateLimit
  build?: object
  env?: object
  coupons?: object[]
  saas?: SaaS
  services: Service[] // required
}

class Service {
  src: string // required
  name?: string
  timeout?: number = 0
  examples?: Example[]
}

class Example {
  name: string
  input: object
  output?: string | object
}

class RateLimit {
  requests?: boolean = true
  requestsInterval?: number = 60000
  requestsMaxPerInterval?: number = 1000
}

class SaaS {
  name?: string
  repo?: string
  heading?: string
  subheading?: string
  logo?: string
  favicon?: string
  features?: Feature[]
  theme?: Theme
}

class Theme {
  name?: string
}

class Feature {
  name: string
  desc: string
  icon: string
}
```

Note that the only **required** property is a non-empty `services` array.

## Simple Example

```json
{
  "name": "hello-world",
  "services": [
    {
      "src": "index.ts"
    }
  ]
}
```

## Advanced Example

This config file contains examples for each service as well as some customizations for the autogenerated SaaS web client.

[saasify.json](./includes/puppet-master-saasify.json ':include :type=code')

## Properties

#### name

Project name. If not provided, this will default to the containing folder's name.

`name` cannot contain underscores. Validation regex `/^[a-zA-Z0-9-]{3,64}$/`.

#### saasifyVersion

Optional platform version. The only allowable value is currently `1`.

#### version

Optional project semver version. Will be used by deployments during publishing.

Defaults to `0.1.0`.

#### amountPerBase

Optional amount to charge for subscriptions per interval *regardless of usage*.

Specified in USD cents. Defaults to `99` which is equivalent to $0.99` USD.

#### amountPerRequest

Optional amount to charge for subscriptions *based on usage per authenticated serverless invocation*.

Specified in USD cents. Defaults to `0.04` cents which is equivalent to $0.0004` USD.

#### amountPerCompute

Optional amount to charge for subscriptions *based on usage per authenticated serverless compute time*.

Specified USD cents per GB-s. Defaults to `0.34` cents which is equivalent to $0.0034` USD.

#### amountPerBandwidth

Optional amount to charge for subscriptions *based on usage per authenticated serverless data transfer in/out*.

Specified in USD cents per GB. Defaults to `20` cents which is equivalent to $0.20` USD per GB transferred.

#### noAuthRateLimit

Optional `RateLimit` for non-authenticated users.

Defaults to the following:

```ts
{
  requests: true
  requestsInterval: 60000
  requestsMaxPerInterval: 1000
}
```

#### authRateLimit

Optional `RateLimit` info for authenticated users.

By default, all authenticated rate limits are disabled.

#### env

Environment variables passed to all of this project's services at runtime.

See the guide on [environment variables & secrets](./env-vars-and-secrets.md) for more info.

#### build.env

Environment variables passed to all of this project's services at build time.

See the guide on [environment variables & secrets](./env-vars-and-secrets.md) for more info.

#### coupons

Optional array of Coupon objects which should be enabled for this deployment.

Coupons are very useful for offering discounts to different customer segments.

Saasify coupons follow the same format as [Stripe coupons](https://stripe.com/docs/billing/subscriptions/discounts). The only difference is that you are not allowed to specify an `id` at the moment due to coupon codes needing to be unique among all projects and deployments.

#### saas

Optional customization for the auto-generated SaaS client.

##### saas.name

Optional display name for the title of the SaaS website.

##### saas.repo

Optional link to the public repository containing the source code for this project.

Note that linking to GitHub issues is a good starting point for providing basic support for your SaaS product.

##### saas.heading

Optional main intro heading in the hero section of the website.

##### saas.subheading

Optional sub-heading in the hero section of the website.

##### saas.logo

Optional path to a local `png` or `svg` image file that will be used as the main logo for the SaaS website.

Path should be relative to the config file. E.g., `'./media/logo.png'`.

##### saas.favicon

Optional path to a local `png` or `ico` image file that will be used as the favicon for the SaaS website.

Path should be relative to the config file. E.g., `'./media/favicon.ico'`.

##### saas.features

Optional array of product features that will be listed on the SaaS website's homepage.

Each feature must have a `name`, `desc`, and `icon`.

The `name` is the feature's title (should be no longer than a few words). The `desc` is the feature's description (should be one to two sentences). The `icon` is the feature's icon, preferably in SVG format.

The `icon` may be any of the following:

- A path to a local `png` or `svg` image file that will be uploaded by Saasify.
- The name of an [Undraw](https://undraw.co/illustrations) SVG (all lowercase, with underscores instead of spaces).
- A URL to a remote `png` or `svg` image file.

##### saas.theme

Optional theme overrides for fine-grained control over the look & feel of the auto-generated SaaS website.

###### saas.theme.name

Name of built-in SaaS theme to use for the SaaS website.

Current valid options are `okta` (default), `sadie`, and `nala`.

For more info on these themes and theme customization, see [themes](./themes.md).

Note that in the future, we're expecting to add many more optional fields here for more fine-grained control over theme customization.

#### services

**Required** non-empty array of `Service` objects that comprise this project's functionality.

Each service is made up of a source TypeScript function and will be transformed by [FTS](https://github.com/transitive-bullshit/functional-typescript) into a serverless HTTPS endpoint that accepts `GET` and `POST` requests.

For more detail on writing these serverless functions, see [functions](./functions.md).

`Service` objects **require** a valid `src` property that points to a TypeSript file with a single function export. The path to the file should be relative to the folder containing the project config file.

They may optionally include `name`, `examples`, and a custom `timeout`.

<p align="center">
  <img src="./_media/undraw/product_teardown.svg" alt="Configuration" width="200" />
</p>
